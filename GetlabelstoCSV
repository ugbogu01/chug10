# load required package
library(flowCore)

# Give directory to wsp file
wsp = ""

# Give the directory to fcs file
fcs_files = "/path/to/fcs_files"

fcs_file = list.files(fcs_files, pattern = ".fcs", full.names = TRUE, recursive = TRUE)

# Specify the cell types of interest for assigning one label per cell
cellTypes = c("CD3+")

# Check the number of cells assigned to each gate
colSums(gatingResult$matrix)

# Count the number of TRUE values in the "Lymphocytes" column 
num_true = sum(gatingResult$matrix[, "Lymphocytes"])

#Save subset of Lymphocytes data to CSV file
file = ("/path.csv", row.names = FALSE)
write.csv(gatingResult$matrix[, "Lymphocytes"], file)

# Count the number of TRUE values in the "Lymphocytes" column
num_true = sum(gatingResult$matrix[, "Lymphocytes"])

# Define the column names to be included in the subset
selected_columns = c("Lymphocytes", "Single Cells", "Live", "CD3+")

# Subset the matrix to include only the specified columns
subset_matrix = gatingResult$matrix[, selected_columns, drop = FALSE]

# Write the subset to a CSV file
file = ("/sc-projects/sc-proj-cc12-srtcell/el/results/cellpopulation_subset.csv", row.names = FALSE)
write.csv(subset_matrix, file)

                                                              56,0-1        Bot
